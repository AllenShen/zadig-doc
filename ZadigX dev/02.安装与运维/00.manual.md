---
title: 高可用运维手册
date: 2021-03-29 16:24:12
permalink: /ZadigX dev/install/overview/
---

coming soon...

<!-- 
## 迁移方案

> 从当前正在使用的集群迁移到新的 K8s 集群。

### 准备工作
- 确保迁入的新集群可以正常连接外网
- 确保迁移过程中，Zadig 系统属于停机状态没有用户使用
- 确保需要挂接的外部集群可以和新集群正常联通
  - 对于使用`直接连接`方式挂接的集群，需要保证 Zadig 所在新集群 -> 外部集群的连通性
  - 对于使用`代理连接`方式挂接的集群，需要保证外部集群 -> Zadig 系统的连通性
- 确保 Zadig 中集成的基础设施在新集群中可以正常连接:
  - 镜像仓库/对象存储/Helm Chart 仓库
  - 系统集成：账号系统/项目管理/代码源/配置管理/Jenkins/Sonar/审批系统
  - 代理地址(如有配置)
  - 邮件配置(如有配置)
  - 网络防火墙配置
- 备份以下数据（若安装 Zadig 时指定了数据库名称，以安装参数中的名称为准）：
    - [MongoDB]数据库：zadig，数据表：zadig_policy 和 zadig-plutus
    - [MySQL]数据库：user，数据表：dex
- 备份对象存储数据
  - 将 MinIO 数据导出至外部对象存储
- 备份当前安装参数，命令：helm get values {zadig-release} -n {zadig-namespace} 

### 迁移步骤
1. 准备新集群上 Zadig 所用到的数据
    - mongodb+mysql，导入备份的数据
    - 导入备份的minIO 数据
2. 在新集群上安装 Zadig 企业版实施工具，并根据命令行提示输入安装参数
`curl -sS https://admin.8slan.com/api/plutus/customer/installer/install_plutus_customer.sh | bash`
3. 使用企业版实施工具进行 Zadig 的安装
  1. 观察zadig 组件的启动时间
4. 域名解析，将流量转入迁移后的 Zadig 系统
迁移后操作
1. 清除浏览器缓存
2. 重新集成 Oauth 用户系统，验证登陆流程
3. 对于所有使用【代理连接】的集群，点击连接后，重新在对应集群执行命令进行重新连接
4. 检查核心业务流程运行正常
5. 接入迁移前旧集群
6. 执行sql，更新数据
7. 验证业务
  1. 运行已有工作流执行构建/部署操作
  2. 新建工作流
  3. 环境页面检查数据展现/workload详情/实时日志
  4. 开始业务迁移

 -->
