---
title: 安装
date: 2023-04-21 09:59:31
permalink: /ZadigX dev/stable/install/
---

## 资源准备

- K8s 集群（版本 >=1.16），建议节点 2 台 8C16G，且对该集群有管理员操作权限
- 可正常连通上述 K8s 集群、且安装了 [kubectl](https://kubernetes.io/docs/tasks/tools/) 客户端的机器
- 网络要求
    - 若选择 IP+Port 的方式访问 ZadigX 系统，请确保 ZadigX 安装集群节点有外部 IP 可供访问
    - 若选择域名方式访问 Zadigx 系统，请准备可用的域名
- [可选]高可用的 MongoDB（版本 >=3.4）
- [可选]高可用的 MySQL（版本 >=5.7）

## 安装

### 客户控制台

1. 第一步：获取授权证书。

与 ZadigX 官方支持人员获取安装脚本和安装许可证。

2. 第二步：安装客户控制台。

执行安装脚本安装客户控制台，安装成功后会输出控制台地址和密码，示例如下：

``` bash
...
plutus customer installation complete
visit {{address}} to access plutus customer
use password: {{password}} to login to plutus
plutus customer installation completed in 36 seconds
```

3. 第三步：登录控制台并上传安装许可证，完成控制台的安装。

### Zadigx

在客户控制台中点击`部署`进入参数配置页面，正确设置安装参数后部署。部署完成后，访问 Zadigx 系统，输入许可证，使用默认账号 admin/zadig 登录系统。

![安装](./_images/install_1.png)

配置参数说明：

| 参数名 | 必填              | 备注 | 
|--------|-----------------------------|---------|--------|
| global.extensions.extAuth.extauthzServerRef.namespace | 是 | Zadigx 安装所在的 Namespace | 
| endpoint.FQDN |  使用域名访问 Zadigx 时必填 | 访问 Zadigx 系统的完整 URL | 
| endpoint.type | 使用 IP+Port 访问 Zadigx 时必填 | 设置为固定值: IP |
| endpoint.IP | 使用 IP+Port 访问 Zadigx 时必填 | K8s 节点任一可外网访问的 IP |
| gloo.gatewayProxies.gatewayProxy.service.httpNodePort |使用 IP+Port 访问 Zadigx 时必填|指定的端口号 < 30000 - 32767> |
| gloo.gatewayProxies.gatewayProxy.service.type | 使用 IP+Port 访问 Zadigx 时必填 | 固定值:  NodePort|
| dex.config.staticClients[0].redirectURIs[0] | 是 | 使用域名方式访问：`http://${endpoint.FQDN}/api/v1/callback`<br>使用 IP+Port 方式访问: `http://${IP}:${PORT}/api/v1/callback`|

如果不使用内置 MongoDB/MySQL，还需配置以下参数：

> 高可用版本使用外置的 MongoDB, MySQL 组件，数据持久化以及高可用性由具体的 MongoDb, MySQL 服务提供商保障。

| 参数名 | 必填              | 备注 | 
|--------|-----------------------------|---------|--------|
| tags.mysql |是 | 是否安装内置的 MySQL，指定为 false| 
| connections.mysql.host |是 | MySQL 连接地址 |
| connections.mysql.auth.user | 是 | MySQL 用户名 |
| connections.mysql.auth.password | 是| MySQL 密码|
| dex.config.storage.config.host | 是| Dex 系统所使用的 MySQL Host|
| dex.config.storage.config.port|是|Dex 系统所使用的 MySQL 端口|
|dex.config.storage.config.user|是|Dex 系统所使用的 MySQL 用户名|
|dex.config.storage.config.password|是|Dex 系统所使用的 MySQL 密码|
| tags.mongodb | 是 | 是否安装内置的 MongoDB，指定为 false |
| connections.mongodb.connectionString | 是 | MongoDB 数据库连接串，配置多个地址时需要进行转义|
|ee.mongodb.db|必填| MongoDB 数据库名称|
