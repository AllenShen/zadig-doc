---
title: 构建模板
date: 2022-05-30 19:50:32
permalink: /v1.12.0/template/build/
---

::: tip 背景
将服务的构建配置抽取成模板，为服务创建构建时可选择基于模板创建，适用于大量服务的构建配置同构的场景。
:::

## 新建构建模板

依次访问`项目 `-> `模板库` -> `构建` 进入构建模板管理页面。

![构建模板](./_images/build_template_1.png)

点击 `+` 按钮 -> 填写模板名称 -> 填写模板配置后保存。

![构建模板](./_images/create_build_template_1.png)

- `构建环境`：参考[构建环境](/v1.12.0/project/build/#构建环境)
- `代码信息`：在构建模板中无需配置，使用构建模板为服务创建构建时再配置
- `构建变量`：参考[构建变量](/v1.12.0/project/build/#构建变量)
- `通用构建脚本`：参考[构建脚本](/v1.12.0/project/build/#通用构建脚本)
- `高级配置`：参考[高级配置](/v1.12.0/project/build/#高级配置)
- `添加步骤`：参考[更多构建步骤](/v1.12.0/project/build/#更多构建步骤)

::: tip
结合使用构建变量 `$REPONAME_<index>` 可巧妙的完成构建模板的配置，比如服务的源代码及编译配置在 A 仓库，Dockerfile 文件在 B 仓库，构建配置中的脚本可组织如下：

``` bash
#!/bin/bash
set -ex

cd $WORKSPACE/$REPONAME_0/service/
cp $WORKSPACE/$REPONAME_1/dockerfiles/$SERVICE.Dockerfile .
make build
docker build -t $IMAGE -f $SERVICE.Dockerfile .
docker push $IMAGE
```

[使用构建模板](#使用构建模板)创建构建时，按照顺序完成对应代码库的配置即可。
:::


## 使用构建模板

创建构建时选择`使用模板` -> 填写构建名称并选择构建模板 -> 选择服务并按需配置代码信息后保存即可。

![构建模板](./_images/create_build_with_template.png)
